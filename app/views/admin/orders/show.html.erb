<div class="container">
 <div class="row">
  <style>
   label {
    font-weight: bold;
   }

   .btn-success {
    margin-right: 40px;
   }

   thead {
    color: rgba(0, 0, 0, 0.6);
    background-color: #e6dcdf;
   }
  </style>

  <div class="col-12 mx-auto">
   <h3 style="padding: 10px 0 30px 10%">
    <span style="background-color: #e6dcdf;">
     注文履歴詳細
    </span>
   </h3>

   <div class="field">
    <label for="customer_full_name">購入者</label>
    <%= link_to @order.customer.full_name, admin_customer_path(customer.id) %>
   </div>

   <div class="field">
    <label for="order_datetime">注文日</label>
    <%= @order.created_at.strftime('%Y/%m/%d') %>
   </div>

   <div class="field">
    <label for="order_address_name">配送先</label>
    <%= @order.address %></br>
    <%= @order.name %>
   </div>

   <div class="field">
    <label for="order_payment_method">支払方法</label>
    <%= @order.payment_method_i18n %>
   </div>

   <%= form_with model: @order, url: admin_order_path(@order.id) do |f| %>
    <div class="field">
     <%= f.label :order_status, "注文ステータス" %>
     <!--%= f.select, :order_status, Oder.order_statuses.key.map {|k| [i18n.t("enums.order.order_status.#{k}"),k]} %>-->
     <%= f.submit "更新", class: "btn btn-success" %>
    </div>
   <% end %>
  </div>

  <div class="col-lg-12">
   <table class="table table-inverse">

    <thead>
     <tr>
      <th>商品名</th>
      <th>単価（税込）</th>
      <th>数量</th>
      <th>小計</th>
      <th>製作ステータス</th>
      <th></th>
     </tr>
    </thead>

    <tbody style="color: rgba(0, 0, 0, 0.6);">
     <% @order.order_details.each do |order_detail| %>
      <tr>
       <!-- 商品名 -->
       <td>
        <%= order_detail.item.name %>
       </td>

       <!-- 単価（税込）-->
       <td>
        <%= order_detail.item.with_tax_price.to_s(:delimited) %>
       </td>

       <!-- 数量 -->
       <td>
        <%= order_detail.quantity %>
       </td>

       <!-- 小計 -->
       <td>
        <%= order_detail.purchase_amount.to_s(:delimited) %>
       </td>

       <%= form_with model: @order, url: admin_order_path(@order.id) do |f| %>
        <!-- 製作ステータス -->
        <td>
         <!--%= f.order_details.select, :crafting_status, Oder_details.crafting_status.key.map {|k| [i18n.t("enums.order_details.crafting_status.#{k}"),k]} %>-->
        </td>

        <!-- 更新ボタン -->
        <td>
         <%= f.submit "更新", class: "btn btn-success" %>
        </td>
       <% end %>

      </tr>
     <% end %>
    </tbody>
   </table>

   <div class="price">
    <div class="field">
     <label for="total">商品合計</label>
     <%= @total.to_s(:delimited) %>円
    </div>

    <div class="field">
     <label for="shipping_fee">送料</label>
     <%= @shipping_fee %>円
    </div>

    <div class="field">
     <label for="bill">請求金額合計</label>
     <%= @order.bill.to_s(:delimited) %>円
    </div>
   </div>
  </div>

 </div>
</div>
